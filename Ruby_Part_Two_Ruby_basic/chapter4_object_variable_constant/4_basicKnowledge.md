#  对象、变量和常量

## 4.1 对象
> 在 Ruby 中，表现数据的基本单位称为对象(object)。 对象的类型非常多，我们这里只介绍一些常用的对象。

- 数值对象
    1、-10、3.1415 等是表示数字的对象，另外还有表示矩阵、复数、质数、公式的对象。
- 字符串对象
    " 你好 "、"hello" 等表示字符序列的对象。 
- 数组对象、散列对象
    表示多个数据的集合的对象。
- 正则表达式对象
    表示匹配模式的对象。
- 时间对象
    比如“2016 年 1 月 31 日早上 9 点”等表示时间的对象。
- 文件对象
    一般我们可以理解为表示文件本身的对象，但确切来说，它是【对文件进行读写操作的对象】。
- 符号对象
    表示用于识别方法等名称的标签的对象。除此以外，Ruby 还有范围对象(range)、异常对象(exception)等。

## 4.2 类
> Ruby 的类(class)表示的就是对象的种类。对象拥有什么特性等，这些都是由类决定的。

### 对象与类的对应表
|对象|类|
:-|:-
数值|Numeric
字符串|String
数组|Array
散列|Hash
正则表达式|Regexp
文件|File
符号|Symbol
> 这个表里的类都是 Ruby 默认提供的，我们也可以按照实际需要**自定义**新的类。

#### 补充说明
“×× 类的对象”，我们一般也会说成“×× 类的实例(instance)”。

所有 Ruby 对象其实都是某个类的实例，因此 Ruby 中的对象和实例的意义几乎是一样的。

另外，我们在强调某个对象是属于某个类时，经常会使用“实例”来代替“对象”。

例如，我们会说“字符串对象 "foo" 是 Sring 类的实例”。

## 4.3 变量
> 变量就像是对象的名片。

Ruby 有四种类型的变量：
- 局部变量（local variable）
    + 命名方式：以英文小写字母或者 _ 开头。
- 全局变量（global variable）
    + 以 $ 开头。
- 实例变量（instance variable）
    + 以 @ 开头。
- 类变量  （class variable）
    + 以 @@ 开头。
> 变量的命名方式决定了变量的种类。

### 伪变量
除了以上四种类型以外，还有一种名为伪变量(pseudo variable)的特殊变量。
（实际上还有一种叫预定义变量(pre-defined variable)的特殊变量。）

伪变量是 Ruby 预先定义好的代表某特定值的特殊变量，因此即使我们在程序中给伪变量赋值，它的值也不会改变。

Ruby 中，nil、true、false、self 等都是伪变量。它们表面上虽然看着像变量， 但实际的行为又与变量有差别，因此称为伪变量。

### 局部变量与全局变量
首先我们了解一下什么是局部变量。局部变量也可称为本地变量。

所谓局部，即变量在程序中的有效范围(也称为变量的作用域)是局部的。

也就是说，在程序某个地方声明的变量名，在其他地方也可以使用，只要这两个地方没有关系，程序就会认为这两个变量是不同的变量。

与局部变量相对的是全局变量。只要全局变量的名称相同，不管变量在程序的哪个部分使用，程序都认为是它们是同一个变量。

举个例子，假设有个程序引用了其他程序作为自己程序的一部分。这时，即使原程序与被引用程序中都有一个相同名称的变量 x，由于 x 是局部变量，因此程序也不会认为这两个变量 x 是同一个变量。

但是，如果是拥有相同名称的全局变量 $x，则程序会认为这两个变量 $x 是相同的变量。

#### 示例
[scopetest.rb](./scopetest.rb) 和 [sub.rb](./sub.rb) 是调查变量作用域的两个小程序

在 scopetest.rb 中，我们预先将变量 $x 和 x 都定义为 0 后，读取 sub.rb 的内容。

在 sub.rb 中，我们再把刚才两个变量的值都 设为 1。

然后，回到 scopetest.rb 程序的第 6 行和第 7 行，我们输出这两个变量的值后会发现，x 的值没有变化，但 $x 的值已经是 1 了。

这是由于在 scopetest.rb 以及 sub.rb 中，程序会把 $x 当 作同一个变量来处理，而把 x 当作不同的变量来处理

#### 小总结
一般我们并不推荐使用全局变量。

全局变量的值在程序的任何地方都可以修改，因此在规 模较大的程序中使用时，会增加程序不必要的复杂度，给阅读程序、修改程序造成意想不到的麻 烦。
本书也很少对全局变量进行说明，示例中也没使用过。

程序首次给局部变量赋值时，该局部变量就被初始化了。如果引用了未初始化的局部变量， 程序会发生错误。

## 4.4 常量
> 常量(constant)的作用和变量一样，是某个对象的“名片”。不过与变量不同的是，对已经赋值的常量再进行赋值时，Ruby 会发出警告。对于程序中多次引用且固定不变的值，我们会用常量来定义。

```
> irb --simple-prompt >> TEST = 1
=> 1
>> TEST = 2
   (irb):2: warning: already initialized constant TEST
   (irb):1: warning: previous definition of TEST was here
   => 2
```

常量以大写英文字母开头。例如，Ruby 的运行版本(RUBY_VERSION)、运行平台(RUBY_PLATFORM)、命令行参数数组(ARGV)等，都是 Ruby 预定义好的常量。

## 4.5 保留字
> 下面表中的单词在程序中作为名称使用时会受到限制。这些受到限制的单词，我们称为**保留字**。在程序中如果不小心使用了 end、next 等作为变量名，Ruby 会提示我们语法错误。
例如：
```
> irb --simple-prompt
>> end = 1
SyntaxError: (irb):1: syntax error, unexpected keyword_end 
end = 1
   ^
           from /usr/local/bin/irb:16:in `<main>'
```
### Ruby保留字一览
|`__LINE__`|`__ENCODING__`|`__FILE__`|BEGIN|END
|:-|:-|:-|:-|:-|
alias|and|begin|break|case
class|def|defined?|do|else
elsif|end|ensure|false|for
if|in|module|next|nil
not|or|redo|rescue|retry
return|self|super|then|true
undef|unless|until|when|while
yield|      |     |    |

## 4.6多重赋值
> 我们已经介绍过“变量=值”这样的变量赋值方法，Ruby 还提供了一个只用一个表达式就能给多个变量赋值的简便方法——**多重赋值**

### 合并多个赋值操作
如：
```
a, b, c, = 1, 2, 3
```
这样就能轻松地将 1、2、3 分别赋值给变量 a、b、c。如果对一组不相关的变量进行多重赋值，程序会变得难懂，因此建议对彼此相关的变量进行多重赋值。

变量前加上 *，表示 Ruby 会将**未分配的值封装为数组赋值给该变量。**
```
a, b, *c = 1, 2, 3, 4, 5
p [a, b, c]    #=> [1, 2, [3, 4, 5]]
a, * b, c = 1, 2, 3, 4, 5
p [a, b, c]    #=> [1, [2, 3, 4], 5]
```

### 交换变量的值
现在我们来考虑一下如何交换变量 a、b 的值。通常，我们需要一个临时变量 tmp 暂时保存变量的值。
```
a, b = 0, 1
tmp = a        # 暂时保存变量a的值
a = b          # 将变量b的值赋值给a
b = tmp        # 将原本变量a的值赋值给变量b
p [a, b]       #=> [1, 0]
```
使用多重赋值，只需一行程序就搞定了。
```
a, b = 0, 1
a, b = b, a     # 交换变量a、b的值 
p [a, b]        #=> [1, 0]
```

### 获取数组的元素
用数组赋值时，如果左边有多个变量，Ruby 会自动获取数组的元素进行多重赋值。
```
ary = [1, 2]
a, b = ary
p a             #=> 1
p b             #=> 2
```
只是希望获取数组开头的元素时，可以像以下示例这样做。左边的变量列表以 , 结束的话，会给人一种“是不是还没写完?”的感觉，建议尽量少用这样的写法。
```
ary = [1, 2]
a, = ary
p a        #=> 1
```

### 变量的命名的方式
- 使用简明易懂的单词
    由于编程语言的方法、类等的名称都使用英语，因此变量也常用英语单词来命名。虽然如此，相比生僻的英语单词，直截了当地使用拼音来命名变量也是不错的选择。

    团队开发时，预先与成员讨论并约定命名规范非常重要。
- 不要过多使用省略的名称
    例如，一个表示开店时间(opening time)的变量，比起使用 optm 这样的缩写，不如直接使  open_time 来命名。

    虽然过长的名称在显示屏上显示时会分行，不便于阅读，但比起难于理解的缩写，老老实实地为变量取个长点的含义清楚的名称，在之后阅读程序时会更容易理解。

    但是，我们也还是有一些约定俗成的短名称变量。比如进行数学、物理等方面的计算时，根据不同的计算对象，坐标使用“x”“y”“z”，速度使用“v”“w”，在表示循环次数 时，一般多用“i”“j”“k”。
- 对于多个单词组合的变量名，使用 _ 隔开各个单词，或者单词以大写字母开头
    也就是说，要么叫作 sort_list_by_name，要么叫作 sortListByName。 

    一般来讲，Ruby 中的**变量名和方法名**使用前者，**类名和模块名**使用后者。

